<!DOCTYPE html>
<!--
  PRODUCT.HTML â€” Product Detail Page
  ====================================
  Shows full details for ONE product.
  
  HOW IT WORKS:
  The URL is: product.html?id=3
  JavaScript reads the "id" from URL, finds that product in
  PRODUCTS array, and dynamically fills the page with its data.
  
  FEATURES:
  - Image gallery with thumbnails
  - Quantity selector (+/-)
  - Scent/variant selector
  - Add to cart button
  - Ingredient tags
  - Related products section
  - Sticky buy bar on mobile
-->
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Product â€” LatherLux</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Lato:wght@300;400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="enhance.css">
</head>
<body>

<div class="bubble-bg" aria-hidden="true"></div>

<nav class="navbar">
  <div class="navbar-inner">
    <a href="index.html" class="nav-logo">
      <div class="nav-logo-icon">ğŸ«§</div>
      LatherLux
    </a>
    <ul class="nav-links">
      <li><a href="index.html">Home</a></li>
      <li><a href="products.html">Products</a></li>
      <li><a href="about.html">About</a></li>
      <li><a href="contact.html">Contact</a></li>
    </ul>
    <div class="nav-actions">
      <div class="nav-search-bar">
        <span>ğŸ”</span>
        <input type="text" placeholder="Search soaps...">
      </div>
      <a href="cart.html" class="nav-icon-btn">ğŸ›’<span class="cart-count" style="display:none">0</span></a>
      <button class="hamburger" aria-label="Menu"><span></span><span></span><span></span></button>
    </div>
  </div>
</nav>

<div class="mobile-menu">
  <a href="index.html">ğŸ  Home</a>
  <a href="products.html">ğŸ§¼ Products</a>
  <a href="about.html">ğŸ’¡ About Us</a>
  <a href="contact.html">ğŸ“¬ Contact</a>
  <a href="cart.html">ğŸ›’ Cart</a>
</div>

<!-- PRODUCT DETAIL AREA: filled dynamically by JS -->
<div class="product-detail" id="productDetail">
  <div class="spinner"></div>
</div>

<!-- RELATED PRODUCTS SECTION -->
<section class="products-section" style="background:var(--warm-white);padding:60px 0;position:relative;z-index:1;">
  <div class="container">
    <div class="section-title">
      <h2>You Might Also Like</h2>
      <div class="title-line"></div>
    </div>
    <div id="relatedProducts" class="products-grid"></div>
  </div>
</section>

<!-- Mobile sticky buy bar (visible only on small screens) -->
<div class="sticky-buy-bar" id="stickyBar" style="display:none;">
  <span class="price" id="stickyPrice"></span>
  <button class="btn btn-primary" onclick="addToCartFromDetail()">ğŸ›’ Add to Cart</button>
</div>

<footer>
  <div class="container">
    <div class="footer-grid">
      <div class="footer-brand">
        <div class="logo">ğŸ«§ LatherLux</div>
        <p>Crafting pure, handmade soaps with love since 2020.</p>
      </div>
      <div class="footer-col">
        <h5>Quick Links</h5>
        <ul>
          <li><a href="index.html">Home</a></li>
          <li><a href="products.html">All Products</a></li>
          <li><a href="cart.html">Cart</a></li>
        </ul>
      </div>
      <div class="footer-col">
        <h5>Categories</h5>
        <ul>
          <li><a href="products.html?cat=herbal">ğŸŒ¿ Herbal</a></li>
          <li><a href="products.html?cat=rose">ğŸŒ¹ Rose</a></li>
          <li><a href="products.html?cat=charcoal">ğŸ–¤ Charcoal</a></li>
          <li><a href="products.html?cat=lavender">ğŸ’œ Lavender</a></li>
          <li><a href="products.html?cat=coffee">â˜• Coffee</a></li>
        </ul>
      </div>
      <div class="footer-col">
        <h5>Contact</h5>
        <div class="footer-contact-item"><span class="icon">âœ‰ï¸</span><span>hello@latherlux.in</span></div>
      </div>
    </div>
    <div class="footer-bottom">
      <p>Â© 2025 LatherLux. Made with ğŸ’› in India.</p>
    </div>
  </div>
</footer>

<button class="back-to-top" title="Back to top">â†‘</button>

<script src="script.js"></script>
<script src="cart.js"></script>
<script>
/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   PRODUCT DETAIL PAGE JAVASCRIPT
   
   The product ID comes from URL: product.html?id=5
   We read it, find the product, and build the page.
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

let currentProduct = null;  // The product being displayed
let selectedQty = 1;        // Current quantity chosen by user

/**
 * loadProduct() â€” Reads URL param, finds product, renders page
 */
function loadProduct() {
  const params = new URLSearchParams(window.location.search);
  const id = parseInt(params.get('id'));
  
  currentProduct = PRODUCTS.find(p => p.id === id);
  
  if (!currentProduct) {
    // Product not found â€” show error
    document.getElementById('productDetail').innerHTML = `
      <div style="text-align:center;padding:80px 24px;">
        <div style="font-size:4rem;margin-bottom:16px;">ğŸ˜•</div>
        <h2>Product not found</h2>
        <p style="margin:12px 0 24px;">We couldn't find that product. It may have been removed.</p>
        <a href="products.html" class="btn btn-primary">Browse All Products</a>
      </div>
    `;
    return;
  }
  
  // Update page title in browser tab
  document.title = `${currentProduct.name} â€” LatherLux`;
  
  renderProductDetail(currentProduct);
  renderRelatedProducts(currentProduct);
  
  // Show mobile sticky bar
  const stickyBar = document.getElementById('stickyBar');
  const stickyPrice = document.getElementById('stickyPrice');
  if (stickyBar) stickyBar.style.display = 'flex';
  if (stickyPrice) stickyPrice.textContent = formatPrice(currentProduct.price);
}

/**
 * renderProductDetail() â€” Builds the product detail HTML
 * This is a large template literal that creates the full layout.
 */
function renderProductDetail(product) {
  const container = document.getElementById('productDetail');
  const discount = Math.round(((product.originalPrice - product.price) / product.originalPrice) * 100);
  
  // Build thumbnail "images" (using emoji for demo â€” replace with real images)
  const thumbsHTML = ['ğŸŒ¸', 'âœ¨', 'ğŸŒ¿', product.emoji].map((em, i) => `
    <div class="gallery-thumb ${i === 0 ? 'active' : ''}" onclick="switchThumb(this, '${em}')">
      <span style="font-size:1.5rem">${em}</span>
    </div>
  `).join('');
  
  // Build scent option buttons
  const scentsHTML = product.scents.map((s, i) => `
    <button class="scent-btn ${i === 0 ? 'active' : ''}" onclick="selectScent(this)">${s}</button>
  `).join('');
  
  // Build ingredient tags
  const ingredientsHTML = product.ingredients.map(ing => `
    <span class="ingredient-tag">${ing}</span>
  `).join('');
  
  container.innerHTML = `
    <!-- Breadcrumb navigation: Home > Products > Product Name -->
    <nav class="breadcrumb">
      <a href="index.html">Home</a>
      <span>â€º</span>
      <a href="products.html">Products</a>
      <span>â€º</span>
      <a href="products.html?cat=${product.category}">${product.categoryLabel}</a>
      <span>â€º</span>
      <span style="color:var(--text-dark)">${product.name}</span>
    </nav>
    
    <div class="product-detail-grid">
      <!-- LEFT: Image Gallery -->
      <div>
        <div class="gallery-main" id="mainImage">
          <div class="placeholder">${product.emoji}</div>
        </div>
        <div class="gallery-thumbs">
          ${thumbsHTML}
        </div>
      </div>
      
      <!-- RIGHT: Product Information -->
      <div class="detail-info">
        <div class="detail-category">${product.categoryLabel}</div>
        <h1 class="detail-title">${product.name}</h1>
        
        <div class="detail-rating">
          <span class="stars">${renderStars(product.rating)}</span>
          <span class="count">${product.rating}/5 (${product.reviews} reviews)</span>
          ${product.isBestseller ? '<span class="badge badge-rose">Bestseller</span>' : ''}
          ${product.isNew ? '<span class="badge badge-herbal">New Arrival</span>' : ''}
        </div>
        
        <div class="detail-price">
          <span class="current">${formatPrice(product.price)}</span>
          <span class="original">${formatPrice(product.originalPrice)}</span>
          <span class="discount">${discount}% OFF</span>
        </div>
        
        <p class="detail-desc">${product.description}</p>
        
        <!-- Scent selector -->
        <div class="detail-options">
          <div class="option-label">Fragrance Intensity</div>
          <div class="scent-options">
            ${scentsHTML}
          </div>
        </div>
        
        <!-- Quantity selector -->
        <div>
          <div class="option-label" style="margin-bottom:10px;">Quantity</div>
          <div class="quantity-control">
            <button class="qty-btn" onclick="changeQtyDetail(-1)">âˆ’</button>
            <input type="number" class="qty-input" id="qtyInput" value="1" min="1" max="10"
                   onchange="selectedQty = parseInt(this.value) || 1">
            <button class="qty-btn" onclick="changeQtyDetail(1)">+</button>
          </div>
        </div>
        
        <!-- Action buttons -->
        <div class="detail-actions">
          <button class="btn btn-primary" onclick="addToCartFromDetail()" style="flex:2;">
            ğŸ›’ Add to Cart
          </button>
          <a href="checkout.html" class="btn btn-gold" onclick="addToCartFromDetail()">
            âš¡ Buy Now
          </a>
        </div>
        
        <!-- Product meta info -->
        <div class="detail-meta">
          <div class="meta-row"><span class="meta-label">Weight:</span><span class="meta-value">${product.weight}</span></div>
          <div class="meta-row"><span class="meta-label">Category:</span><span class="meta-value">${product.categoryLabel}</span></div>
          <div class="meta-row"><span class="meta-label">Stock:</span><span class="meta-value" style="color:var(--deep-sage);">âœ“ In Stock</span></div>
          <div class="meta-row"><span class="meta-label">Delivery:</span><span class="meta-value">Free above â‚¹500</span></div>
          <div class="meta-row"><span class="meta-label">Returns:</span><span class="meta-value">7-day return policy</span></div>
        </div>
        
        <!-- Ingredients list -->
        <div class="ingredients-list">
          <h4>ğŸŒ¿ Key Ingredients</h4>
          <div class="ingredient-tags">${ingredientsHTML}</div>
        </div>
      </div>
    </div>
  `;
  
  // Trigger fade-in animations
  setTimeout(initScrollReveal, 50);
}

/**
 * switchThumb() â€” Changes the main image when thumbnail is clicked
 * Updates which thumbnail has the .active border,
 * and swaps the emoji/image in the main display.
 */
function switchThumb(thumbEl, emoji) {
  // Remove active from all thumbs
  document.querySelectorAll('.gallery-thumb').forEach(t => t.classList.remove('active'));
  thumbEl.classList.add('active');
  
  // Update main image
  const mainImg = document.getElementById('mainImage');
  if (mainImg) {
    mainImg.innerHTML = `<div class="placeholder">${emoji}</div>`;
  }
}

/**
 * selectScent() â€” Highlights the selected scent button
 */
function selectScent(btn) {
  document.querySelectorAll('.scent-btn').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
}

/**
 * changeQtyDetail() â€” Changes quantity on product detail page
 * @param {number} delta - +1 or -1
 */
function changeQtyDetail(delta) {
  const input = document.getElementById('qtyInput');
  if (!input) return;
  let newQty = parseInt(input.value) + delta;
  newQty = Math.max(1, Math.min(10, newQty)); // Clamp between 1 and 10
  input.value = newQty;
  selectedQty = newQty;
}

/**
 * addToCartFromDetail() â€” Adds current product with selected quantity to cart
 */
function addToCartFromDetail() {
  if (!currentProduct) return;
  addToCart(currentProduct.id, selectedQty);
}

/**
 * renderRelatedProducts() â€” Shows 4 products from same category
 * Filters out the current product, shuffles, takes 4.
 */
function renderRelatedProducts(product) {
  const container = document.getElementById('relatedProducts');
  if (!container) return;
  
  // Get products from same category, excluding current
  const sameCategory = PRODUCTS.filter(p => p.category === product.category && p.id !== product.id);
  // Also include some from other categories to make 4
  const others = PRODUCTS.filter(p => p.category !== product.category && p.id !== product.id);
  
  const related = [...sameCategory, ...others].slice(0, 4);
  container.innerHTML = related.map(p => createProductCard(p)).join('');
  setTimeout(initScrollReveal, 50);
}

// Run on page load
loadProduct();
</script>
<script src="enhance.js"></script>
</body>
</html>
